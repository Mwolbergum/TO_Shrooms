---
title: "TO_Shrooms"
author: "Fishbowlz"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Get Libraries
```{r}
library(caret)
library(C50)
library(dplyr)
```

# Read Data
```{r}
shrooms <- read.csv("mushrooms.csv", stringsAsFactors = TRUE)
str(shrooms)
```

# Clean Data
```{r}
#in our dataset all veil types are "p" so they were removed
shrooms$veil.type <- NULL

# class is our output variable so it was made numeric, 1 means poisonous, 0  means edible
shrooms$class <- ifelse(shrooms$class == "p", 1, 0)
#shrooms$stalk.root <- ifelse(shrooms$stalk.root == "?", "missing", shrooms$stalk.root)

colnames(shrooms)[1] ="is_poisonous"

```

```{r}
# Using model.matrix to convert all the factors to dummy variables

shroomsmm <- as.data.frame(model.matrix(~.-1,shrooms))
str(shroomsmm)
```

```{r}
# 50 - 50 split
set.seed(12345)

shrooms_prop <- 0.5
train_shrooms <- sample(1:nrow(shroomsmm),shrooms_prop*nrow(shroomsmm))
shrooms_train <- shroomsmm[train_shrooms, ]
shrooms_test <- shroomsmm[-train_shrooms, ]

# You need to separate the x and y from each other when using a KNN
shrooms_train_x <- shrooms_train[, -1]
shrooms_test_x <- shrooms_test[, -1]

shrooms_train_y <- shrooms_train[, 1]
shrooms_test_y <- shrooms_test[, 1]

```

# Build Logsistic
```{r}
shrooms_logistic <- glm(is_poisonous ~ ., data = shrooms_train, family = "binomial")
summary(shrooms_logistic)
```
# Predict Logistic
```{r}
shrooms_logistic_pred <- predict(shrooms_logistic, shrooms_test, type = "response")
shrooms_logistic_pred_bin <- ifelse (shrooms_logistic_pred >= 0.3, 1, 0)

confusionMatrix(as.factor(shrooms_logistic_pred_bin), as.factor(shrooms_test$is_poisonous), positive = "1")
```


## Decision Tree Model

```{r}
shrooms_dt <- C5.0(as.factor(is_poisonous) ~ ., data = shrooms_train)

plot(shrooms_dt)

summary(shrooms_dt)
```

```{r}
shrooms_dt_pred_bin <- predict(shrooms_dt, shrooms_test)

confusionMatrix(as.factor(shrooms_dt_pred_bin), as.factor(shrooms_test$is_poisonous), positive = "1")
```